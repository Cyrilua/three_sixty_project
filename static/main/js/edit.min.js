var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.createTemplateTagFirstArg=function(p){return p.raw=p};$jscomp.createTemplateTagFirstArgWithRaw=function(p,q){p.raw=q;return p};
$(function(){function p(a,b,e){var c=document.createElement("div");c.classList.add(a);$(c).attr({"data-name":b,"data-id":e});e=document.createElement("div");e.classList.add("role");e.innerText=b;b=document.createElement("div");var d=b.classList;d.add(a+"__remove");d.add("remove-item");a=document.createElement("div");a.classList.add("cross-in-circle");d=document.createElement("div");d.classList.add("circle");var k=document.createElement("div");k.classList.add("line-1");var w=document.createElement("div");
w.classList.add("line-2");c.prepend(e);e.prepend(b);b.prepend(a);a.prepend(d);d.prepend(k);k.prepend(w);return c}function q(a,b,e){"success"===b||1>e.length?a.classList.contains("error")&&a.classList.remove("error"):"error"===b&&0<e.length&&a.classList.add("error")}function l(a){a=$(a).parent().children(".popup");var b=a.children(".popup_message");a.stop().animate({opacity:0},300,function(){$(this).css({display:"none"});b.children().remove()})}function n(a,b){if(0<b.length){a=$(a).parent().children(".popup");
var e=a.children(".popup_message");e.children().remove();for(var c=0;c<b.length;c++){var d=document.createElement("span");d.classList.add("popup_message-text");d.textContent=b[c];e.append(d)}a.css({display:"block",opacity:0}).stop().animate({opacity:1},300)}else l(a)}function y(a,b){b=b.prop("id");if("name"===b||"surname"===b||"patronymic"===b)!(f.name||f.surname||f.patronymic)||g.name||g.surname||g.patronymic?a.prop({disabled:!0}):a.prop({disabled:!1});else if("birthdate"===b)f.birthdate?a.prop({disabled:!1}):
a.prop({disabled:!0});else if("email"===b||"password_for_email"===b)f.email&&f.password_for_email?a.prop({disabled:!1}):a.prop({disabled:!0});else if("email_code"===b)f.email_code?a.prop({disabled:!1}):a.prop({disabled:!0});else if("username"===b)f.username?a.prop({disabled:!1}):a.prop({disabled:!0});else if("password_old"===b||"password1"===b||"password2"===b)f.password_old&&f.password1&&f.password2?a.prop({disabled:!1}):a.prop({disabled:!0});else throw Error("Unexpected values");}function m(a,b,
e){var c=a[0].id;"password_old"===c?(f.password_old=0<e.password_old.length,l(a),y(b,a)):"password_for_email"===c?(f.password_for_email=0<e.password_for_email.length,l(a),y(b,a)):"email_code"===c?(f.email_code=0<e.email_code.length,l(a),y(b,a)):$.ajax({url:"/edit/check_input/"+c,type:"post",data:{csrfmiddlewaretoken:r,id:c,values:e},success:function(d){"password_old"!==c&&q(a[0],d.resultStatus,d.resultError);if("name"===c)"success"===d.resultStatus?(f.name=!0,g.name=!1,l(a)):"error"===d.resultStatus&&
(f.name=!1,g.name=0<d.resultError.length,n(a,d.resultError));else if("surname"===c)"success"===d.resultStatus?(f.surname=!0,g.surname=!1,l(a)):"error"===d.resultStatus&&(f.surname=!1,g.surname=0<d.resultError.length,n(a,d.resultError));else if("patronymic"===c)"success"===d.resultStatus?(f.patronymic=!0,g.patronymic=!1,l(a)):"error"===d.resultStatus&&(f.patronymic=!1,g.patronymic=0<d.resultError.length,n(a,d.resultError));else if("birthdate"===c)"success"===d.resultStatus?(f.birthdate=!0,g.birthdate=
!1,l(a)):"error"===d.resultStatus&&(f.birthdate=!1,g.birthdate=0<d.resultError.length,n(a,d.resultError));else if("email"===c)"success"===d.resultStatus?(f.email=!0,g.email=!1,l(a)):"error"===d.resultStatus&&(f.email=!1,g.email=0<d.resultError.length,n(a,d.resultError));else if("username"===c)"success"===d.resultStatus?(f.username=!0,g.username=!1,l(a)):"error"===d.resultStatus&&(f.username=!1,g.username=0<d.resultError.length,n(a,d.resultError));else if("password_old"===c)console.log("\u0421\u0442\u0430\u0440\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c");
else if("password1"===c)console.log(d),t.val(""),f.password2=!1,g.password2=!1,l(t),"success"===d.resultStatus?(f.password1=!0,g.password1=!1,l(a),$("#password2").prop({disabled:!1})):"error"===d.resultStatus&&(f.password1=!1,g.password1=!0,n(a,d.resultError),$("#password2").prop({disabled:!0}));else if("password2"===c)"success"===d.resultStatus?(f.password2=!0,g.password2=!1,l(a)):"error"===d.resultStatus&&(f.password2=!1,g.password2=!0,n(a,d.resultError));else throw Error("Unexpected values");y(b,
a)},error:function(){}})}function J(){680>=parseFloat(z.width())+parseFloat(z.css("margin-left"))+parseFloat(z.css("margin-right"))+30+parseFloat(A.width())?A.css({position:"absolute",right:"0",bottom:"calc(100% + 14px)"}):A.css({position:"static"});A.removeClass("hide")}var h=$("body"),r=$('input[name="csrfmiddlewaretoken"]').val();$(".col-center");var C=$(".modal"),D=$("#email_code"),U=$("#modal_success"),K=$(".left-content__photo"),V=$(".upd-photo"),L=$(".head-menu-img"),W=$("#username"),u=$("#password_old"),
E=$("#password1"),t=$("#password2"),B=$("#email"),v=$("#password_for_email"),M=$("#name"),N=$("#surname"),O=$("#patronymic"),x=$("#birthdate"),F=$("#btnName"),G=$("#btnPassword"),P=$("#btnBirthdate"),X=$("#btnUsername"),Q=$("#btnEmail"),z=$(".info__name"),A=$(".info__company"),R=$(".position__substrate"),S=$(".platform__substrate"),H=R.children("._hint-down-click").children("._hint-down-block").children(".menu"),I=S.children("._hint-down-click").children("._hint-down-block").children(".menu"),T,f=
{username:!1,password_old:!1,password1:!1,password2:!1,email:!1,password_for_email:!1,email_code:!1,name:!1,surname:!1,patronymic:!1,birthdate:!1},g={username:!1,password_old:!1,password1:!1,password2:!1,email:!1,password_for_email:!1,email_code:!1,name:!1,surname:!1,patronymic:!1,birthdate:!1};J();"date"!==x.prop("type")&&x.datepicker({onSelect:function(a,b,e){m(x,P,{birthdate:a})},dateFormat:"d.m.yyyy",position:"top left"});h.on("click",".left-content__delete-photo",function(a){a.preventDefault();
$.ajax({url:"edit/photo/delete",type:"post",data:{csrfmiddlewaretoken:r},success:function(b){console.log(b.new_photo_url);$(K).attr({src:b.new_photo_url});$(L).attr({src:b.new_photo_url})},statusCode:{400:function(){throw Error("Error 400 - \u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u0437\u0430\u043f\u0440\u043e\u0441");},403:function(){throw Error("Error 403 - \u0414\u043e\u0441\u0442\u0443\u043f \u0437\u0430\u043f\u0440\u0435\u0449\u0451\u043d");},404:function(){throw Error("Error 404 - \u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430");
},500:function(){throw Error("Error 500 - \u0412\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u044f\u044f \u043e\u0448\u0438\u0431\u043a\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0430");}},error:function(){throw Error("\u0427\u0442\u043e - \u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a :(");}})});h.on("click",".left-content__update-photo",function(a){a.preventDefault();$(V).trigger("click")});h.on("change",".upd-photo",function(){var a=this.files;console.log(a);if("undefined"!=
typeof a){var b=new FormData;$.each(a,function(e,c){b.append(e,c)});console.log(b);$.ajax({url:"edit/photo/update",type:"post",data:b,cache:!1,processData:!1,contentType:!1,success:function(e){console.log(e.new_photo_url);$(K).attr({src:e.new_photo_url});$(L).attr({src:e.new_photo_url})},statusCode:{400:function(){throw Error("Error 400 - \u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u0437\u0430\u043f\u0440\u043e\u0441");},403:function(){throw Error("Error 403 - \u0414\u043e\u0441\u0442\u0443\u043f \u0437\u0430\u043f\u0440\u0435\u0449\u0451\u043d");
},404:function(){throw Error("Error 404 - \u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430");},500:function(){throw Error("Error 500 - \u0412\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u044f\u044f \u043e\u0448\u0438\u0431\u043a\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0430");}},error:function(){throw Error("\u0427\u0442\u043e - \u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a :(");}})}});h.on("click",".modal",function(a){if($(a.target).hasClass("modal")||
"modal_close"===a.target.id)sessionStorage.removeItem("new_email"),C.toggleClass("hide")});h.on("focus",".input-field",function(){var a=$(this)[0].id,b;for(b in g)if(b===a)if(g[b])$(this).parent().children(".popup").css({display:"block",opacity:0}).stop().animate({opacity:1},300);else break});h.on("focusout",".input-field",function(){$(this).parent().children(".popup").stop().animate({opacity:0},300,function(){$(this).css({display:"none"})})});h.on("input",".input-field",function(a){a=$(this)[0].id;
console.log(a);if("password_old"===a||"password_for_email"===a){var b=$(this).parent().children(".popup");b.addClass("old");$(this).removeClass("error");b.stop().animate({opacity:0},300,function(){$(this).remove()});"password_old"===a?g.password_old=!1:"password_for_email"===a&&(g.password_for_email=!1)}});h.on("input","#username",function(){$(this).val($(this).val().toLowerCase());var a=$(this);m(a,X,{username:a.val()})});h.on("input","#password_old",function(){var a=$(this);m(a,G,{password_old:a.val()})});
h.on("input","#password1",function(){var a=$(this);m(a,G,{password_old:u.val(),password1:a.val(),password2:t.val()})});h.on("input","#password2",function(){var a=$(this);m(a,G,{password1:E.val(),password2:a.val()})});h.on("input","#email",function(){var a=$(this);m(a,Q,{email:a.val()})});h.on("input","#password_for_email",function(){var a=$(this);m(a,Q,{password_for_email:a.val()})});h.on("input","#email_code",function(){var a=$(this);m(a,U,{email_code:a.val()})});h.on("input","#name",function(){var a=
$(this);m(a,F,{name:a.val()})});h.on("input","#surname",function(){var a=$(this);m(a,F,{surname:a.val()})});h.on("input","#patronymic",function(){var a=$(this);m(a,F,{patronymic:a.val()})});h.on("input","#birthdate",function(){var a=$(this);m(a,P,{birthdate:a.val()})});h.on("click",".button-save",function(a){var b=$(this).attr("data-part-url");if("name"===b)var e={name:M.val(),surname:N.val(),patronymic:O.val()};else if("birthdate"===b)e={birthdate:x.val()};else if("email"===b)e={email:B.val(),password_for_email:v.val()};
else if("email_code"===b)e={email:sessionStorage.getItem("new_email"),email_code:D.val()};else if("username"===b)e={username:W.val()};else if("password"===b)e={password_old:u.val(),password1:E.val(),password2:t.val()};else throw Error("Unexpected argument values");$.ajax({url:"edit/save/"+b,type:"post",data:{csrfmiddlewaretoken:r,values:e},success:function(c){$(a.target).prop({disabled:!0});var d=$(a.target).parent(),k=d.children(".setting__substrate").children(".setting__value");d=d.parent().parent().parent().children(".setting__close").children(".setting__mini").children(".setting__2-block").children(".setting__value");
"email_code"===b&&(d=$(".setting__email"),k=$(d[1]),d=$(d[0]));if("name"===b)M.val(c.name),N.val(c.surname),O.val(c.patronymic),z.text(c.name+" "+c.surname),J(),k.text(c.surname+" "+c.name+" "+c.patronymic),d.text(c.surname+" "+c.name+" "+c.patronymic),$(".head-menu-name").text(c.name+" "+c.surname),f.name=!1,f.surname=!1,f.patronymic=!1,g.name=!1,g.surname=!1,g.patronymic=!1;else if("birthdate"===b)x.val(c.birthdate.date),k.text(""+c.birthdate.text),d.text(""+c.birthdate.text),f.birthdate=!1,g.birthdate=
!1;else if("email"===b)v.val(""),f.password_for_email=!1,g.password_for_email=!1,"error"===c.resultStatus?(f.email=!0,g.email=!1,g.password_for_email=!0,q(v[0],c.resultStatus,c.listErrors.password_for_email),n(v,c.listErrors.password_for_email),v.focus()):"success"===c.resultStatus&&(f.email=!1,g.email=!1,sessionStorage.setItem("new_email",B.val()),B.val(""),C.toggleClass("hide"),delete e.password_for_email,$.ajax({url:"edit/save/email/send_mail",type:"post",data:{csrfmiddlewaretoken:r,values:e},
success:function(){},statusCode:{400:function(){throw Error("Error 400 - \u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u0437\u0430\u043f\u0440\u043e\u0441");},403:function(){throw Error("Error 403 - \u0414\u043e\u0441\u0442\u0443\u043f \u0437\u0430\u043f\u0440\u0435\u0449\u0451\u043d");},404:function(){throw Error("Error 404 - \u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430");},500:function(){throw Error("Error 500 - \u0412\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u044f\u044f \u043e\u0448\u0438\u0431\u043a\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0430");
}},error:function(){throw Error("\u0427\u0442\u043e - \u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a :(");}}));else if("email_code"===b)"error"===c.resultStatus?(g.email_code=!0,q(D[0],c.resultStatus,c.listErrors),n(D,c.listErrors),v.focus()):"success"===c.resultStatus&&(k.text(""+c.email),d.text(""+c.email),sessionStorage.removeItem("new_email"),C.toggleClass("hide"));else if("username"===b)B.val(c.username),k.text(""+c.username),d.text(""+c.username),f.username=!1,g.username=
!1;else if("password"===b)u.val(""),E.val(""),t.val(""),t.prop({disabled:!0}),f.password_old=!1,f.password1=!1,f.password2=!1,g.password_old=!1,g.password1=!1,g.password2=!1,"error"===c.resultStatus&&(g.password_old=!0,q(u[0],c.resultStatus,c.listErrors.old_password),n(u,c.listErrors.old_password),u.focus());else throw Error("Unexpected argument values");},statusCode:{400:function(){throw Error("Error 400 - \u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u0437\u0430\u043f\u0440\u043e\u0441");
},403:function(){throw Error("Error 403 - \u0414\u043e\u0441\u0442\u0443\u043f \u0437\u0430\u043f\u0440\u0435\u0449\u0451\u043d");},404:function(){throw Error("Error 404 - \u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430");},500:function(){throw Error("Error 500 - \u0412\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u044f\u044f \u043e\u0448\u0438\u0431\u043a\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0430");}},error:function(){throw Error("\u0427\u0442\u043e - \u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a :(");
}})});h.on("click",".setting__edit",function(){var a=$(this.closest(".setting")),b=a.children(".setting__close");a=a.children(".setting__open");if(b.hasClass("show")&&a.hasClass("hide"))b.removeClass("show"),b.addClass("hide"),a.removeClass("hide"),a.addClass("show");else if(b.hasClass("hide")&&a.hasClass("show"))a.removeClass("show"),a.addClass("hide"),b.removeClass("hide"),b.addClass("show");else throw Error("Invalid attributes");});h.on("click","._hint-up-click",function(){var a=$(this.closest("._hint-click")),
b=$(a).children("._hint-down-click");a.toggleClass("active");b.toggle();T=$(this).parent()});$(window).on("mouseup",function(a){var b=T;"none"===$(b).children("._hint-down-click").css("display")||null!==a.target.closest("._hint-up-click")&&null!==a.target.closest(".position__add")&&$(b).children("._hint-up-click").hasClass("position__add")||null!==a.target.closest(".platform__add")&&$(b).children("._hint-up-click").hasClass("platform__add")||null!==a.target.closest("._hint-down-click")&&!a.target.classList.contains("item__block")||
($(b).toggleClass("active"),$(b).children("._hint-down-click").toggle())});h.on("click",".item__block",function(a){var b=a.target.closest("._hint-click"),e,c=$(this).attr("data-name"),d=$(this).attr("data-id");$(b).hasClass("platform__substrate")?e="platform":$(b).hasClass("position__substrate")&&(e="position");$.ajax({url:"/edit/"+e+"/add/"+d,type:"post",data:{csrfmiddlewaretoken:r,type:e,id:d,name:c},success:function(k){$(b).before(p(e,c,d));$(b).parent().children(".empty").addClass("hide");$(a.target).parent().remove();
("platform"===e&&1>I.children(".menu__item").length||"position"===e&&1>H.children(".menu__item").length)&&$(b).addClass("hide")},error:function(){}})});h.on("click",".remove-item",function(){if($(this).hasClass("platform__remove"))var a="platform";else if($(this).hasClass("position__remove"))a="position";else throw Error("Unexpected values");var b=$(this).parent().parent(),e=b.attr("data-name"),c=b.attr("data-id");$.ajax({url:"/edit/"+a+"/remove/"+c,type:"post",data:{csrfmiddlewaretoken:r,type:a,
id:c,name:e},success:function(d){"position"===a&&1>H.children(".menu__item").length?R.removeClass("hide"):"platform"===a&&1>I.children(".menu__item").length&&S.removeClass("hide");d=document.createElement("div");d.classList.add("menu__item");var k=document.createElement("div");k.classList.add("item__block");$(k).attr({"data-name":e,"data-id":c});k.innerText=e;var w=document.createElement("div");w.classList.add("item__line");d.prepend(w);d.prepend(k);if("platform"===a)I.prepend(d);else if("position"===
a)H.prepend(d);else throw Error("Unexpected values");1===b.parent().children(".platform, .position").length&&b.parent().children(".empty").removeClass("hide");b.remove()},error:function(){}})})});
