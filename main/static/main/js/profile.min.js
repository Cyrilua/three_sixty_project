var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.createTemplateTagFirstArg=function(e){return e.raw=e};$jscomp.createTemplateTagFirstArgWithRaw=function(e,g){e.raw=g;return e};
$(function(){function e(a,b){$(".snackbar-container").remove();y(d);$.ajax({url:"loading",type:"get",data:{selectedCategory:b},beforeSend:function(c,f){t&&t.abort();h=null;t=c;p.addClass("loading")},success:function(c){$(".active-sort[data-category="+a+"]").removeClass("active-sort");$(".category[data-category="+b+"]").addClass("active-sort");p.children(".notifications").empty().prepend(c.content);h=b},complete:function(c,f){p.removeClass("loading");g();"error"===f&&Snackbar.show({text:"\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0434\u0430\u043d\u043d\u044b\u0445.",
textColor:"#ff0000",customClass:"custom center",showAction:!1,duration:3E3})},error:function(){h=a}})}function g(){if(!p.hasClass("loading"))for(var a=$(".no-viewed"),b=0;b<a.length;b++)z(a[b],!1)}function z(a,b){var c=a.getBoundingClientRect().top+30,f=a.getBoundingClientRect().left+30,r=a.getBoundingClientRect().right-30,u=a.getBoundingClientRect().bottom-25,v=document.documentElement.clientWidth,C=document.documentElement.clientHeight;!$(a).hasClass("visible-load")&&(b||u<C&&120<c&&r<v&&0<f)&&
(b=a.getAttribute("data-id"),$.ajax({url:"viewing/"+b,type:"post",data:{csrfmiddlewaretoken:A,category:h},beforeSend:function(){$(a).addClass("visible-load")},success:function(k){$(a).removeClass("no-viewed");$(a).removeClass("is_unshown");0<k.notificationsCount.polls?(l.text(k.notificationsCount.polls),l.removeClass("hide")):l.addClass("hide");0<k.notificationsCount.results?(m.text(k.notificationsCount.results),m.removeClass("hide")):m.addClass("hide");0<k.notificationsCount.invites?(n.text(k.notificationsCount.invites),
n.removeClass("hide")):n.addClass("hide")},complete:function(){$(a).removeClass("visible-load")},error:function(){}}))}function y(a){for(var b=0;b<a.length;b++)a[b].finish||$.ajax(a[b].request)}var q=$("body"),A=$('input[name="csrfmiddlewaretoken"]').val(),D=$(".center-content-information-more-details"),w=$(".center-content-information-name"),x=$(".center-content-information-company"),p=$(".body__bottom"),l=$("#polls-notif"),m=$("#results-notif"),n=$("#invites-notif"),B=$("#showNewNotif"),h,t,d=[];
window.onbeforeunload=function(){y(d)};window.onunload=function(){};$(window).resize(function(){g()});$(window).scroll(function(){g()});q.on("click",".show-new-poll",function(a){$(".bad-search").remove();$(".is_unshown").removeClass("is_unshown");B.addClass("hide");g()});setInterval(function(){h&&!p.hasClass("loading")&&$.ajax({url:"new_notif/",type:"get",data:{category:h},success:function(a){0<a.notificationsCount.polls?(l.text(a.notificationsCount.polls),l.removeClass("hide")):l.addClass("hide");
0<a.notificationsCount.results?(m.text(a.notificationsCount.results),m.removeClass("hide")):m.addClass("hide");0<a.notificationsCount.invites?(n.text(a.notificationsCount.invites),n.removeClass("hide")):n.addClass("hide");a.content&&(B.removeClass("hide"),$(".notifications").prepend(a.content))},error:function(){}})},6E4);q.on("click",".notification__open",function(){z($(this).parent().parent()[0],!0)});q.on("click",".category",function(a){a=$(".active-sort").attr("data-category");var b=$(this).attr("data-category");
a!==b&&e(a,b)});q.on("click",".center-content-information-more-btn",function(){D.toggle();$(this).toggleClass("active-more");$(this).hasClass("active-more")?$(this).children(".center-content-information-more-btn-text").text("\u0421\u043a\u0440\u044b\u0442\u044c \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e"):$(this).children(".center-content-information-more-btn-text").text("\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e")});
q.on("click",".notification__close ",function(a){var b=$(this).parent().parent();a=b.attr("data-id");var c;$.ajax({url:"notification/"+a+"/remove/",type:"post",data:{csrfmiddlewaretoken:A},beforeSend:function(f,r){if(!d[c]){c=d.length;f.abort();d.push({request:r,finish:!1});b.addClass("hide");var u=setTimeout(function(){d[c].finish||$.ajax(r)},5E3);Snackbar.show({text:"\u0423\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u0435 \u0443\u0434\u0430\u043b\u0435\u043d\u043e",customClass:"custom no-animation center",
actionText:"\u041e\u0442\u043c\u0435\u043d\u0430",actionTextColor:"#5699FF",width:"910px",pos:"bottom-center",duration:5E3,onActionClick:function(v){clearTimeout(u);$(v).remove();d[c].finish=!0;b.removeClass("hide")}})}},success:function(f){b.remove()},complete:function(){d[c].finish=!0},error:function(){b.removeClass("hide");Snackbar.show({text:"\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0438 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f",
textColor:"#ff0000",customClass:"custom center",showAction:!1,duration:3E3})}})});(function(){$(function(){680>=parseFloat(w.width())+parseFloat(w.css("margin-left"))+parseFloat(w.css("margin-right"))+30+parseFloat(x.width())&&x.css({position:"absolute",right:"0",bottom:"calc(100% + 14px)"});x.removeClass("hide")});$(".category[data-category=polls]").trigger("click")})()});
