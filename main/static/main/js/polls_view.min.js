var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.createTemplateTagFirstArg=function(d){return d.raw=d};$jscomp.createTemplateTagFirstArgWithRaw=function(d,l){d.raw=l;return d};
$(function(){function d(a,b){c.hasClass("loading")||c.hasClass("full")||(c.addClass("loading"),g.addClass("disabled"),w.removeClass("hide"),b&&(x.removeClass("hide"),window.scrollTo(0,0),window.scrollTo(0,b)),$.ajax({url:"loading/"+q+"/",type:"get",data:{count:a,type:h,sort:y},success:function(e){""!==e.newElems&&null!==e.newElems&&(c[0].insertAdjacentHTML("beforeend",e.newElems),q=c.children(".category-item").length,k());e.is_last?c.addClass("full"):c.remove("full")},complete:function(){c.removeClass("loading");
g.removeClass("disabled");w.addClass("hide");b&&(x.addClass("hide"),window.scrollTo(0,0),window.scrollTo(0,b))},error:function(){}}))}function l(a,b){var e=a.getBoundingClientRect().top+100,r=a.getBoundingClientRect().left+30,G=a.getBoundingClientRect().right-30,H=a.getBoundingClientRect().bottom-30,I=document.documentElement.clientWidth,J=document.documentElement.clientHeight;!$(a).hasClass("visible-load")&&(b||H<J&&120<e&&G<I&&0<r)&&(b=a.getAttribute("data-id"),$.ajax({url:"viewing/"+b,type:"post",
data:{csrfmiddlewaretoken:t},beforeSend:function(){$(a).addClass("visible-load")},success:function(O){$(a).removeClass("no-viewed");$(a).removeClass("new-poll")},complete:function(){$(a).removeClass("visible-load")},error:function(){}}))}function k(){if("polls"===h)for(var a=$(".no-viewed"),b=0;b<a.length;b++)l(a[b])}function z(){A=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight);
B=m;m=window.pageYOffset;B<=m&&m+document.documentElement.clientHeight+150>A&&!c.hasClass("loading")&&!c.hasClass("full")&&d(3*Math.ceil(document.documentElement.clientHeight/370)+9)}function C(){c.children().remove();q=c.children(".category-item").length;var a=D-E;c.removeClass("full");d(3*Math.ceil(document.documentElement.clientHeight/370)+9,a)}var f=$("body"),t=$('input[name="csrfmiddlewaretoken"]').val(),n=$(".templates"),F="date",K=$(".my-templates"),L=$(".my-templates-block"),M=$(".category-empty"),
c=$(".category-content"),q=c.children(".category-item").length,h=$(".category-sort--active").attr("data-category"),A,m=0,B=window.scrollY;window.scrollTo(0,0);var g=$(".sort"),D=g[0].getBoundingClientRect().y,E=D,u=$("#polls-notif"),x=$("._preloader"),w=$("._updater"),N=$(".show-new-poll"),v=$(".unshow-polls");if(0<$(".mdc-select").length){var p=new mdc.select.MDCSelect(document.querySelector(".mdc-select"));var y=p.value;p.listen("MDCSelect:change",function(){F!==p.value&&(y=F=p.value,C())})}d(3*
Math.ceil(document.documentElement.clientHeight/370)+9);k();f.on("click",".category",function(){$(this).hasClass("category-sort--active")||(g.children(".category-sort--active").removeClass("category-sort--active"),$(this).addClass("category-sort--active"),h=$(this).attr("data-category"),C())});f.on("click",".more",function(a){if(n.hasClass("few"))$(this).text("\u0421\u043a\u0440\u044b\u0442\u044c");else if(n.hasClass("many"))$(this).text("\u0411\u043e\u043b\u044c\u0448\u0435 \u0448\u0430\u0431\u043b\u043e\u043d\u043e\u0432");
else throw Error("Unexpected attribute");n.toggleClass("few");n.toggleClass("many")});f.on("click",".delete",function(a){var b=$(this).parent().attr("data-id"),e=setTimeout(function(){$.ajax({url:"template/remove/",type:"post",data:{csrfmiddlewaretoken:t,id:b},success:function(){$(a.target).parent().parent().parent().parent().remove();1>K.children(".template-item").length&&L.addClass("hide")},error:function(){}})},3E3);Snackbar.show({text:"\u0428\u0430\u0431\u043b\u043e\u043d \u0431\u0443\u0434\u0435\u0442 \u0443\u0434\u0430\u043b\u0435\u043d \u0447\u0435\u0440\u0435\u0437 3 \u0441\u0435\u043a\u0443\u043d\u0434\u044b, \u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",
showAction:!0,duration:3E3,actionText:"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c",actionTextColor:"red",customClass:"custom no-animation",width:400,pos:"bottom-center",onActionClick:function(r){clearTimeout(e);$(r).animate({opacity:0},200)}})});f.on("click",".template-new",function(){$.ajax({url:"poll/create/",type:"post",data:{csrfmiddlewaretoken:t},success:function(a){window.location.href=a.urlNewPoll},error:function(){}})});setInterval(function(){$.ajax({url:"new_notif",type:"get",data:{category:h},
success:function(a){0<a.notifications?(u.text(a.notifications),u.removeClass("hide"),a.newElems&&"polls"===h&&(N.removeClass("hide"),M.addClass("hide"),v[0].insertAdjacentHTML("afterbegin",a.newElems))):u.addClass("hide")},error:function(){}})},1E3);f.on("click",".show-new-poll",function(){$(this).addClass("hide");var a=v.children(".poll-item"),b=v.html();c[0].insertAdjacentHTML("afterbegin",b);a.remove();$(".new-poll").removeClass("new-poll");k()});$(window).resize(function(){console.log("resize");
z();k()});$(window).scroll(function(){E=g[0].getBoundingClientRect().y;z();k()});f.on("click",".no-viewed",function(){l(this,!0)})});
