var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.createTemplateTagFirstArg=function(e){return e.raw=e};$jscomp.createTemplateTagFirstArgWithRaw=function(e,p){e.raw=p;return e};
$(function(){function e(a,b){c.hasClass("loading")||c.hasClass("full")||(l.addClass("disabled"),A.removeClass("hide"),b&&(B.removeClass("hide"),window.scrollTo(0,0),window.scrollTo(0,b)),$.ajax({url:"loading/"+x+"/",type:"get",data:{count:a,type:h,sort:C},success:function(d){""!==d.newElems&&null!==d.newElems&&(c[0].insertAdjacentHTML("beforeend",d.newElems),x=c.children(".category-item").length,m());d.is_last?c.addClass("full"):c.remove("full")},complete:function(){l.removeClass("disabled");A.addClass("hide");
b&&(B.addClass("hide"),window.scrollTo(0,0),window.scrollTo(0,b))},error:function(){}}))}function p(a,b){var d=a.getBoundingClientRect().top+100,f=a.getBoundingClientRect().left+30,q=a.getBoundingClientRect().right-30,y=a.getBoundingClientRect().bottom-30,z=document.documentElement.clientWidth,N=document.documentElement.clientHeight;!$(a).hasClass("visible-load")&&(b||y<N&&120<d&&q<z&&0<f)&&(b=a.getAttribute("data-id"),$.ajax({url:"viewing/"+b,type:"post",data:{csrfmiddlewaretoken:D},beforeSend:function(){$(a).addClass("visible-load")},
success:function(r){$(a).removeClass("no-viewed");$(a).removeClass("new-poll");0<r.notifications?(k.text(r.notifications),k.removeClass("hide"),r.newElems&&"polls"===h&&(E.removeClass("hide"),F.addClass("hide"),t[0].insertAdjacentHTML("afterbegin",r.newElems))):k.addClass("hide")},complete:function(){$(a).removeClass("visible-load")},error:function(){}}))}function m(){if("polls"===h)for(var a=$(".no-viewed"),b=0;b<a.length;b++)p(a[b])}function G(){H=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,
document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight);I=u;u=window.pageYOffset;I<=u&&u+document.documentElement.clientHeight+150>H&&!c.hasClass("loading")&&!c.hasClass("full")&&e(3*Math.ceil(document.documentElement.clientHeight/370)+9)}function J(){c.children().remove();x=c.children(".category-item").length;var a=K-L;c.removeClass("full");e(3*Math.ceil(document.documentElement.clientHeight/370)+9,a)}var n=$("body"),D=$('input[name="csrfmiddlewaretoken"]').val(),
v=$(".templates"),M="date";$(".my-templates");$(".my-templates-block");var F=$(".category-empty"),c=$(".category-content"),x=c.children(".category-item").length,h=$(".category-sort--active").attr("data-category"),H,u=0,I=window.scrollY;window.scrollTo(0,0);var l=$(".sort"),K=l[0].getBoundingClientRect().y,L=K,k=$("#polls-notif"),B=$("._preloader"),A=$("._updater"),E=$(".show-new-poll"),t=$(".unshow-polls");window.onbeforeunload=function(){for(var a=g,b=0;b<a.length;b++)a[b].finish||$.ajax(a[b].request)};
window.onunload=function(){};if(0<$(".mdc-select").length){var w=new mdc.select.MDCSelect(document.querySelector(".mdc-select"));var C=w.value;w.listen("MDCSelect:change",function(){M!==w.value&&(C=M=w.value,J())})}e(3*Math.ceil(document.documentElement.clientHeight/370)+9);m();n.on("click",".category",function(){$(this).hasClass("category-sort--active")||(l.children(".category-sort--active").removeClass("category-sort--active"),$(this).addClass("category-sort--active"),h=$(this).attr("data-category"),
J())});n.on("click",".more",function(a){if(v.hasClass("few"))$(this).text("\u0421\u043a\u0440\u044b\u0442\u044c");else if(v.hasClass("many"))$(this).text("\u0411\u043e\u043b\u044c\u0448\u0435 \u0448\u0430\u0431\u043b\u043e\u043d\u043e\u0432");else throw Error("Unexpected attribute");v.toggleClass("few");v.toggleClass("many")});var g=[];n.on("click",".delete",function(a){a.preventDefault();var b=$(this).parent().attr("data-id"),d=$(a.target).parent().parent().parent().parent();$.ajax({url:"template/remove/",
type:"post",data:{csrfmiddlewaretoken:D,id:b},beforeSend:function(f,q){if(!g[b]){b=g.length;f.abort();g.push({request:q,finish:!1});d.addClass("hide");f=$(".my-templates");0===f.children(".template-item").not(".hide").length&&f.prepend('<span class="pale" id="no-my-templates">\u041d\u0435\u0442 \u0448\u0430\u0431\u043b\u043e\u043d\u043e\u0432</span>');var y=setTimeout(function(){g[b].finish||$.ajax(q)},5E3);Snackbar.show({text:'\u0428\u0430\u0431\u043b\u043e\u043d "undefined" \u0443\u0434\u0430\u043b\u0435\u043d',
customClass:"custom no-animation center",actionText:"\u041e\u0442\u043c\u0435\u043d\u0430",actionTextColor:"#5699FF",width:"910px",duration:5E3,onActionClick:function(z){clearTimeout(y);$(z).remove();g[b].finish=!0;$("#no-my-templates").remove();d.removeClass("hide")}})}},success:function(f){d.remove()},complete:function(){g[b].finish=!0},error:function(){$("#no-my-templates").remove();d.removeClass("hide");Snackbar.show({text:'\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0448\u0430\u0431\u043b\u043e\u043d\u0430 "undefined"',
textColor:"#ff0000",customClass:"custom center",showAction:!1,duration:3E3})}})});setInterval(function(){$.ajax({url:"new_notif",type:"get",data:{category:h},success:function(a){0<a.notifications?(k.text(a.notifications),k.removeClass("hide"),a.newElems&&"polls"===h&&(E.removeClass("hide"),F.addClass("hide"),t[0].insertAdjacentHTML("afterbegin",a.newElems))):k.addClass("hide")},error:function(){}})},6E4);n.on("click",".show-new-poll",function(){$(".bad-search").remove();$(this).addClass("hide");var a=
t.children(".poll-item"),b=t.html();c[0].insertAdjacentHTML("afterbegin",b);a.remove();$(".new-poll").removeClass("new-poll");m()});$(window).resize(function(){G();m()});$(window).scroll(function(){L=l[0].getBoundingClientRect().y;G();m()});n.on("click",".no-viewed",function(){p(this,!0)})});
