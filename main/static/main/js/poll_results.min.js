$(function(){function g(){var b=l(),c=$(".results");console.log(b);$.ajax({url:"save_as/",type:"post",data:{csrfmiddlewaretoken:m,template:b},beforeSend:function(){c.addClass("disabled")},success:function(){Snackbar.show({text:"\u0428\u0430\u0431\u043b\u043e\u043d \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0441\u043e\u0437\u0434\u0430\u043d",showAction:!0,duration:3E3,actionText:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",actionTextColor:"green",customClass:"custom"})},error:function(){Snackbar.show({text:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0438 \u0448\u0430\u0431\u043b\u043e\u043d\u0430",
showAction:!0,duration:3E3,actionText:"\u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u044c",actionTextColor:"red",customClass:"custom",onActionClick:function(d){$(d).animate({opacity:0},200,function(){g()})}})},complete:function(){c.removeClass("disabled")}})}function l(){var b=$(".poll"),c=b.children(".questions").children(".question"),d={name:b.children(".poll__name").text(),description:b.children(".poll_description").text(),questions:[],color:b.attr("data-poll-color"),countQuestion:c.length};
c.each(function(e,a){var f=$(a).attr("data-question-type");d.questions.push({id:n(),serialNumber:e+1,type:f,name:$(a).children(".question__head").children(".question__name ").text()});if("radio"===f||"checkbox"===f)a=$(a).children(".question__answers").children(".answer"),d.questions[e].answers=[],d.questions[e].countAnswers=a.length,$(a).each(function(h,p){h=$(p).children(".answer__text").text();d.questions[e].answers.push(h)});else if("range"===f){a=$(a).children(".question__statistics-answers").children(".statistics-answer");
f=a.first().children(".value").text();var q=a.last().children(".value").text();d.questions[e].settingsSlider={min:f,max:q,step:Math.max(a[1]-a[0],a[2]-a[1])}}else if("openQuestion"!==f)throw Error("unexpected attribute when receiving a poll");});return d}function n(){for(var b="",c=0;33>c;c++)b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return b}var k=$("body"),m=$('input[name="csrfmiddlewaretoken"]').val();(function(){$(".question__statistics-answers").each(function(b,
c){b=$(c).children(".statistics-answer");var d=Math.ceil(c.offsetWidth/b.length/3*2);console.log(b.length);b.each(function(e,a){e=$(a).children(".percent").text();e*=c.offsetHeight/100;a.style.width=d+"px";a.style.height=e+"px"})})})();k.on("click",".menu__back",function(){location.href="/polls/"});k.on("click","#saveAs",function(){g()})});
